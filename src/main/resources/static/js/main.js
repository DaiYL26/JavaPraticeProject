const AttributeBinding={data:()=>({user:null,searchInput:null,searchRes:null,dictId:1,words:[],curIndex:0,is_lreaning:!1,is_detail:!1,is_test:!1,is_home:!0,is_done:!1,is_null:!1,status:{},isConfirm:!1,is_recognize:!1,speelWord:"",is_invaild:!1,testInfo:"请输入单词的拼写"}),methods:{logout(){$.get("api/logout",function(e){1==e&&(localStorage.removeItem("user"),$(location).attr("href","/"))})},doSearch(){let e=this;this.searchRes=null,null!==this.searchInput&&""!=this.searchInput.trim()&&(/^[a-zA-Z]+$/.test(this.searchInput)?$.post("/query/en",{word:e.searchInput},function(t){e.searchRes=JSON.parse(t.data),$("#myModal").modal()}):$.post("/query/zh",{mean:e.searchInput,limit:5},function(t){e.searchRes=JSON.parse(t.data),$("#myModal").modal()}))},starLreaning(){this.is_home=!1,this.is_lreaning=!0,$("#button-addon2").attr("disabled",!0)},recognize(e){this.is_lreaning=!1,this.is_detail=!0,this.is_recognize=e,$("#button-addon2").attr("disabled",!1)},next(){if(this.is_detail=!1,this.is_recognize){if(this.curIndex+1>=this.words.length)return this.curIndex=0,this.is_test=!0,void $("#button-addon2").attr("disabled",!0);this.curIndex++}this.is_lreaning=!0,$("#button-addon2").attr("disabled",!0)},toReview(){$(location).attr("href","/review")},toBooks(){$(location).attr("href","/books")},testConfirm(){let e=this;""!=this.speelWord.trim()?(this.isConfirm=!0,e.speelWord.trim()===e.words[e.curIndex].word.trim()?bs4pop.notice("拼写正确",{position:"topcenter",type:"success"}):bs4pop.notice("拼写错误，已加入重点复习对象",{position:"topcenter",type:"warning"}),setTimeout(function(){if(e.isConfirm=!1,e.speelWord.trim()===e.words[e.curIndex].word.trim()){if(console.log("正确"),$.post("/home/addRecord",{userid:e.user.id,dictID:e.status.dictID,id:e.words[e.curIndex].wordRank,isMem:!0}),e.curIndex+1>=e.words.length)return e.is_test=!1,e.is_done=!0,$.post("/home/setPlanStatus",{userid:e.user.id}),e.curIndex=0,void $("#button-addon2").attr("disabled",!1);e.curIndex++}else{if(console.log("拼写错误"),$.post("/home/addRecord",{userid:e.user.id,dictID:e.status.dictID,id:e.words[e.curIndex].wordRank,isMem:!1}),e.curIndex+1>=e.words.length)return e.is_test=!1,e.is_done=!0,$.post("/home/setPlanStatus",{userid:e.user.id}),$("#button-addon2").attr("disabled",!1),void(e.curIndex=0);e.curIndex++}e.speelWord=""},2e3)):bs4pop.notice("请输入单词拼写",{position:"topcenter",type:"primary"})},playAudio(e){let t=$("#wordAudio")[0];1==e?(t.src=this.curSpeech.uk,t.load(),t.play()):2==e?(t.src=this.curSpeech.us,t.load(),t.play()):3==e&&(t.src="https://dict.youdao.com/dictvoice?word="+this.searchRes.word+"&type=1",t.load(),t.play())},getWords(e,t,s,i,r){let o=this;console.log(e,t,s,i,r),$.post("/home/getWords",{userid:e,dictID:t,count:s,hadMem:i,isMore:r},function(e){if(200==e.code)for(let t=0;t<e.data.length;t++){let s=JSON.parse(e.data[t]);o.words.push(s)}})},load(){let e=this;$.post("/home/getStatus",{userid:e.user.id},function(t){if(200==t.code){let s=t.data;if(null==s)return e.is_home=!1,void(e.is_null=!0);e.status=s;let i=!1;s.isDone&&(i=!0),e.getWords(e.user.id,s.dictID,s.count,s.hadMem,i)}})}},computed:{imgUrl(){return"/images/book/book"+this.status.dictID+".png"},curWord(){return null===this.words?"":this.words[this.curIndex]},searchWordExchange(){let e=this.searchRes.exchange.split("/"),t="";for(let s=0;s<e.length;s++)e[s]=e[s].replace(/p:/,"过去式："),e[s]=e[s].replace(/d:/,"过去分词："),e[s]=e[s].replace(/i:/,"现在分词："),e[s]=e[s].replace(/3:/,"第三人称单数："),e[s]=e[s].replace(/r:/,"形容词比较级："),e[s]=e[s].replace(/t:/,"形容词最高级："),e[s]=e[s].replace(/s:/,"名词复数形式："),t+=e[s];return t},curSpeech(){let e=this.words[this.curIndex],t="https://dict.youdao.com/dictvoice?word=";return{uk:t+e.ukspeech,us:t+e.usspeech}}},created(){let e=localStorage.getItem("user");this.user=JSON.parse(e),this.load()}};Vue.createApp(AttributeBinding).mount("#app");let handler=setInterval(function(){$.get("api/isLogin",function(e){!0!==e.data&&(clearInterval(handler),alert("您的账号已经在别处登录！"),$(location).attr("href","/"))})},3e3);